<html>
	<head>
		<meta charset="utf-8" />
		<title>Israel Hiking Map - OSM</title>
		<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5.1/leaflet.css" />
		<!--[if lte IE 8]>
		<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5.1/leaflet.ie.css" />
		<![endif]-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<link rel="icon" href="favicon.png" />
	</head>
	<!--
Todo List:
	Add search box using nominatim
	Expand and collapse info
	Legend (also expand and collapse)
	Add edit link to OSM
	permalink for mail attachments
	-->
	<body style="margin:0; padding:0; height:100%">
		<div class="container" style="margin:auto;font-family:arial;">
			<div id="Info" class="Infos">
				<!-- This part will hold all the information and links of the english version -->
				<!-- the links will be set later on in the script part, use "class" tag and not the full link path -->
				<H1 id="Header">Israel Hiking Project</H1>
				<p> This map was generated from <a class="OSM">Open Street Map (OSM)</a> data where it can be be viewed and edited. All you need to do is create an account and start mapping. Note that the changes will not affect this map instantly.</p>
				<H4> Below are some links related to this project </H4>
				<ul>
					<li>See <a class="Github">Github</a> for instructions on how to create the map by yourself and links to map downloads.</li>
					<li>See <a class="OSMWiki">Israel OSM Wiki Project</a> for common rules of the Israeli Open Street Map community.</li>
					<li>See <a class="OSMForum">Israel OSM Forum</a> for the Israeli Open Street Map forum where you can post questions and look for answers.</li>
				</ul>
				<i>
				<p align="right">
					Thank you for your support!<br>
					Harel and Zeev<br>
					<button onclick="ChangeLanguage()">עברית</button>
				</p>
				</i>
			</div>
			<div id="Info-he" class="Infos">
				<!-- This part will hold all the information and links of the hebrew version -->
				<!-- the links will be set later on in the script part, use "class" tag and not the full link path -->
				<H1 id="Header-he">פרוייקט מפת הטיולים הפתוחה של ישראל</H1>
				<p> המפה הזו נוצרה בעזרת מידע מ- <a class="OSM">Open Street Map</a> שם ניתן לראות ולערוך אותו. כל שיש לעשות הוא לפתוח חשבון ולהתחיל למפות. שימו לב, המפה אינה מתעדכנת באופן מיידי.</p>
				<H4> להלן כמה קישורים הקשורים לפרוייקט </H4>
				<ul>
					<li><a class="Github">Github</a> הוראות איך ליצור את המפה בעצמך וקישורים להורדת מפות</li>
					<li><a class="OSMWiki">Israel OSM Wiki Project</a> חוקים נפוצים של קהילת הממפים הישראלית של OSM</li>
					<li><a class="OSMForum">Israel OSM Forum</a> היכן שניתן למצוא תשובות ולשאול שאלות לגבי המיפוי</li>
				</ul>
				<i>
				<p align="left">
					תודה על תרומתכם!<br>
					הראל וזאב<br>
					<button onclick="ChangeLanguage()">English</button>
				</p>
				</i>
			</div>
			<!-- Need to use 78% instead of 80% for the map's div to overcome an IE bug -->
			<div id="map" style="float:left;width:78%; height:100%;"></div>
		</div>
		<script src="http://cdn.leafletjs.com/leaflet-0.5.1/leaflet.js"></script>
		<script> 
			// the following function is missing in IE, therefore we add it manually:
			if (typeof document.getElementsByClassName != 'function') {
				document.getElementsByClassName = function() {
					var elms = document.getElementsByTagName('*');
					var ei = new Array();
					for (i=0;i<elms.length;i++) {
						if (elms[i].getAttribute('class')) {
							ecl = elms[i].getAttribute('class').split(' ');
							for (j=0;j<ecl.length;j++) {
								if (ecl[j].toLowerCase() == arguments[0].toLowerCase()) {
									ei.push(elms[i]);
								}
							}
						} else if (elms[i].className) {
							ecl = elms[i].className.split(' ');
							for (j=0;j<ecl.length;j++) {
								if (ecl[j].toLowerCase() == arguments[0].toLowerCase()) {
									ei.push(elms[i]);
								}
							}
						}
					}
					return ei;
				}
			}
			
			// Links for both hebrew and english info
			//---------------------------------------------------
			var links = document.getElementsByClassName('OSM');
			for (var i = 0; i < links.length; ++i) {
				links[i].href = "http://www.openstreetmap.org/";
				links[i].target = "_blank"
			}
			links = document.getElementsByClassName('OruxMaps');
			for (var i = 0; i < links.length; ++i) {
				links[i].href = "https://play.google.com/store/apps/details?id=com.orux.oruxmaps";
				links[i].target = "_blank"
			}
			links = document.getElementsByClassName('Github');
			for (var i = 0; i < links.length; ++i) {
				links[i].href = "https://github.com/HarelM/maperitive-rulesets/tree/master/IsraelHiking#create-israel-hiking-map-similar-to-israel-trails-committee-itc";
				links[i].target = "_blank"
			}
			links = document.getElementsByClassName('OSMWiki');
			for (var i = 0; i < links.length; ++i) {
				links[i].href = "http://wiki.openstreetmap.org/wiki/WikiProject_Israel";
				links[i].target = "_blank"
			}
			links = document.getElementsByClassName('OSMForum');
			for (var i = 0; i < links.length; ++i) {
				links[i].href = "http://forum.openstreetmap.org/viewforum.php?id=33";
				links[i].target = "_blank"
			}
			links = document.getElementsByClassName('JoinDropbox');
			for (var i = 0; i < links.length; ++i) {
				links[i].href = "http://db.tt/iB36k7K";
				links[i].target = "_blank"
			}
			links = document.getElementsByClassName('DownloadOrux');
			for (var i = 0; i < links.length; ++i) {
				links[i].href = "https://googledrive.com/host/0B-qrsEBJWXhQUGVBM3lHZTF2eXc/";
				links[i].target = "_blank"
			}
			links = document.getElementsByClassName('DownloadOzi');
			for (var i = 0; i < links.length; ++i) {
				links[i].href = "https://www.dropbox.com/sh/h8ye52ahotghta1/tTeUkbTspw";
				links[i].target = "_blank"
			}
		</script>
		<script>
			// Code
			// -----------------------------------
			var map = L.map('map').setView([31.773, 35.12], 13);
			L.tileLayer('Tiles/{z}/{x}/{y}.png', {
				attribution: 'Map data &copy; <a href="http://openstreetmap.org" target="_blank">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/" target="_blank">CC-BY-SA</a> <button onclick="onLocateClick()">Show my location</button>',
				minZoom : 7,
				maxZoom: 15
			}).addTo(map);
			
			function onLocationFound(e) {
				var radius = e.accuracy / 2;
				L.marker(e.latlng).addTo(map)
				.bindPopup("You are within " + radius + " meters from this point").openPopup();
				L.circle(e.latlng, radius).addTo(map);
			}
			
			map.on('locationfound', onLocationFound);
			
			function onLocateClick() {
				map.locate({setView: true, maxZoom: 15});
			}
			
			var container = document.getElementById('container');
			var mapdiv = document.getElementById('map');
			var bHebrew = false;
			
			function ChangeLanguage()
			{
				var info;
				bHebrew = (bHebrew == false);
				if (bHebrew == false)
				{
					document.getElementById('Info-he').style.display='none';
					document.getElementById('Info').style.display = "block";
					info = document.getElementById('Info');
					info.style.styleFloat = 'left';
					info.style.cssFloat = 'left';
					document.dir = 'ltr';
				}
				else
				{
					document.getElementById('Info').style.display='none';
					document.getElementById('Info-he').style.display = "block";
					info = document.getElementById('Info-he');
					info.style.styleFloat = 'right';
					info.style.cssFloat = 'right';
					document.dir = 'rtl';
				}
			}
			ChangeLanguage();
			
			var isMobile = (((window.matchMedia) && (window.matchMedia('(max-device-width: 960px)').matches)) || (screen.width <= 960));
			var infos = document.getElementsByClassName('Infos');
			for (var i = 0; i < infos.length; ++i) {
				if (isMobile == true)
				{
					
					infos[i].style.width = '80%';
					infos[i].style.styleFloat = 'center';
					infos[i].style.cssFloat = 'center';
					infos[i].style.margin.left = '10%';
					infos[i].style.marginLeft = '10%';
					infos[i].style.margin.right = '10%';
					infos[i].style.marginRight = '10%';
					mapdiv.style.styleFloat = 'center';
					mapdiv.style.cssFloat = 'center';
					mapdiv.style.margin.left = '11%';
					mapdiv.style.marginLeft = '11%';
					mapdiv.style.margin.right = '11%';
					mapdiv.style.marginRight = '11%';
					// couldn't make the following order: header, map, info
				}
				else
				{
					infos[i].style.width = '18%';
					infos[i].style.margin.left = '1%';
					infos[i].style.marginLeft = '1%';
					infos[i].style.margin.right = '1%';
					infos[i].style.marginRight = '1%';
					infos[i].style.fontSize = '14px';
				}
			}
		</script>
	</body>
</html>
